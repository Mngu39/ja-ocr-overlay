:root{
  --bg:#0b0b0c; --ink:#e8e8ea; --muted:#a9abb3; --accent:#4da3ff;
  --box:#4da3ff; --box-active:#00d4ff; --pop:#141417; --border:#2a2a31;
  --fill:#4da3ff22;        /* 선택 박스 내부 채움(옅음) */
  --ord-bg:#1b1f2a;        /* 번호뱃지 배경 */
  --anki:#2bd2a0;          /* 안키/암기박사 보유 색 */
  --navy:#7fb3ff;          /* 일반DB 색 */
}

*{ box-sizing:border-box; }
html,body{
  margin:0; height:100%;
  background:var(--bg); color:var(--ink);
  font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial,
              "Apple SD Gothic Neo","Noto Sans CJK KR","Noto Sans JP","Malgun Gothic", sans-serif;
}
#stage{ position:relative; width:100%; min-height:100vh; display:grid; place-items:center; padding:10px; }

#img{ max-width:100%; height:auto; display:block; border-radius:10px; box-shadow:0 6px 30px rgba(0,0,0,.4); }
#overlay{ position:absolute; inset:0; margin:auto; pointer-events:auto; }
#hint{ position:absolute; left:0; right:0; bottom:18px; text-align:center; color:var(--muted); font-size:14px; }

/* OCR 박스 */
.box{ position:absolute; border:2px solid var(--box); border-radius:10px; cursor:pointer; background:transparent; }
.box:hover{ box-shadow:0 0 0 2px rgba(77,163,255,.18) inset; }
.box.selected{ border-color:var(--box-active); background:var(--fill); }
.box .ord{
  position:absolute; right:6px; top:6px; min-width:22px; height:22px;
  padding:0 6px; border-radius:999px; background:var(--ord-bg); color:#cfe2ff;
  display:flex; align-items:center; justify-content:center; font-size:13px; font-weight:700;
}

/* 메인 팝업 */
.popover{
  position:absolute; max-width:min(92vw, 900px); background:var(--pop); color:var(--ink);
  border:1px solid var(--border); border-radius:14px; padding:12px; box-shadow:0 12px 40px rgba(0,0,0,.5); z-index:50;
}
.pop-head{ display:flex; align-items:center; justify-content:flex-end; gap:10px; margin:2px 0 6px; }
.drag-handle{ cursor:grab; }
.drag-handle:active{ cursor:grabbing; }

.sep{ border:none; border-top:1px solid var(--border); margin:8px 0; }

.ruby-line{ line-height:1.9; font-size:18px; color:#cfd4ff; word-break:break-word; }
.ruby-line ruby{ ruby-position:over; ruby-align:center; }
.ruby-line rt{ font-size:12px; color:#9fb3ff; }

.trans-line{ font-size:18px; line-height:1.7; color:#e7f6ff; word-break:break-word; }

.btn{ background:var(--accent); color:#021323; border:none; padding:8px 12px; border-radius:10px; font-weight:600; cursor:pointer; }
.btn.ghost{ background:transparent; color:var(--muted); border:1px solid var(--border); }
.btn.sm{ padding:6px 10px; font-size:12px; }

/* 서브팝업 */
.subpop{
  position:absolute; max-width:86vw; background:var(--pop); color:var(--ink);
  border:1px solid var(--border); border-radius:12px; padding:8px 10px; z-index:60; box-shadow:0 8px 30px rgba(0,0,0,.5);
}
.sub-head{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:6px; }
.sub-title a{ color:#bcd8ff; text-decoration:underline; }
.sub-lemma{ color:#9fb3ff; font-size:13px; margin-left:6px; }
.sub-row{ margin:6px 0; font-size:15px; line-height:1.6; }
.kwrap{ display:flex; flex-wrap:wrap; gap:6px; }
.k{ padding:6px 8px; border-radius:8px; font-weight:700; }
.k.anki{ background:rgba(43,210,160,.15); border:1px solid var(--anki); color:#d9fff3; }
.k.db{ background:rgba(127,179,255,.14); border:1px solid var(--navy); color:#e6f0ff; }
.k small{ display:block; font-weight:500; opacity:.9; }

/* 수정 다이얼로그 */
dialog{ border:none; border-radius:12px; background:var(--pop); color:var(--ink); }
.edit-form{ display:flex; flex-direction:column; gap:8px; min-width:min(86vw, 560px); }
textarea{ width:100%; background:#11121a; color:var(--ink); border:1px solid var(--border); border-radius:10px; padding:8px; font-size:16px; }
menu{ display:flex; justify-content:flex-end; gap:8px; margin:0; padding:0; }
